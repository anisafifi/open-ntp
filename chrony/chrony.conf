# ================================
# PRIMARY NTP NODE - STRATUM 2/3
# ================================

# ===== UPSTREAM SOURCES =====
server time1.google.com iburst minpoll 4 maxpoll 6
server time2.google.com iburst minpoll 4 maxpoll 6
server time3.google.com iburst minpoll 4 maxpoll 6
server time4.google.com iburst minpoll 4 maxpoll 6
server time.cloudflare.com iburst minpoll 4 maxpoll 6
pool pool.ntp.org iburst minpoll 4 maxpoll 6

# ===== ACCESS CONTROL =====
allow 0.0.0.0/0

# ===== DDOS PROTECTION =====
ratelimit interval 1 burst 32 leak 8
clientloglimit 100000

# ===== STORAGE =====
driftfile /var/lib/chrony/chrony.drift
dumpdir /var/run/chrony
logdir /var/log/chrony

log measurements statistics tracking refclocks
logchange 0.5

makestep 1.0 3
initstepslew 30 time1.google.com time.cloudflare.com
maxupdateskew 20

# ===== CLOCK DISCIPLINE =====
rtcsync
leapsecmode slew
maxslewrate 1000

# ===== NTS =====
ntsserverkey  /etc/nginx/ssl-certificates/time.hixbe.com.key
ntsservercert /etc/nginx/ssl-certificates/time.hixbe.com.crt

# ===== FAILSAFE MODE =====
local stratum 10 orphan
